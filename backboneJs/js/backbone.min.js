(function(a,b){if(typeof define==="function"&&define.amd){define(["underscore","jquery","exports"],function(e,f,d){a.Backbone=b(a,d,e,f)})}else{if(typeof exports!=="undefined"){var c=require("underscore");b(a,exports,c)}else{a.Backbone=b(a,{},a._,(a.jQuery||a.Zepto||a.ender||a.$))}}}(this,function(s,c,F,h){var q=s.Backbone;var j=[];var r=j.slice;c.VERSION="1.1.2";c.$=h;c.noConflict=function(){s.Backbone=q;return this};c.emulateHTTP=false;c.emulateJSON=false;var p=c.Events={on:function(I,L,K){if(!H(this,"on",I,[L,K])||!L){return this}this._events||(this._events={});var J=this._events[I]||(this._events[I]=[]);J.push({callback:L,context:K,ctx:K||this});return this},once:function(J,M,K){if(!H(this,"once",J,[M,K])||!M){return this}var I=this;var L=F.once(function(){I.off(J,L);M.apply(this,arguments)});L._callback=M;return this.on(J,L,K)},off:function(J,R,K){if(!this._events||!H(this,"off",J,[R,K])){return this}if(!J&&!R&&!K){this._events=void 0;return this}var Q=J?[J]:F.keys(this._events);for(var P=0,L=Q.length;P<L;P++){J=Q[P];var S=this._events[J];if(!S){continue}if(!R&&!K){delete this._events[J];continue}var N=[];for(var O=0,M=S.length;O<M;O++){var I=S[O];if(R&&R!==I.callback&&R!==I.callback._callback||K&&K!==I.context){N.push(I)}}if(N.length){this._events[J]=N}else{delete this._events[J]}}return this},trigger:function(K){if(!this._events){return this}var J=r.call(arguments,1);if(!H(this,"trigger",K,J)){return this}var L=this._events[K];var I=this._events.all;if(L){d(L,J)}if(I){d(I,arguments)}return this},listenTo:function(K,I,M){var J=this._listeningTo||(this._listeningTo={});var L=K._listenId||(K._listenId=F.uniqueId("l"));J[L]=K;if(!M&&typeof I==="object"){M=this}K.on(I,M,this);return this},listenToOnce:function(O,I,P){if(typeof I==="object"){for(var M in I){this.listenToOnce(O,M,I[M])}return this}if(a.test(I)){var N=I.split(a);for(var J=0,L=N.length;J<L;J++){this.listenToOnce(O,N[J],P)}return this}if(!P){return this}var K=F.once(function(){this.stopListening(O,I,K);P.apply(this,arguments)});K._callback=P;return this.listenTo(O,I,K)},stopListening:function(L,J,N){var K=this._listeningTo;if(!K){return this}var I=!J&&!N;if(!N&&typeof J==="object"){N=this}if(L){(K={})[L._listenId]=L}for(var M in K){L=K[M];L.off(J,N,this);if(I||F.isEmpty(L._events)){delete this._listeningTo[M]}}return this}};var a=/\s+/;var H=function(P,N,I,L){if(!I){return true}if(typeof I==="object"){for(var K in I){P[N].apply(P,[K,I[K]].concat(L))}return false}if(a.test(I)){var O=I.split(a);for(var J=0,M=O.length;J<M;J++){P[N].apply(P,[O[J]].concat(L))}return false}return true};var d=function(N,L){var O,M=-1,K=N.length,J=L[0],I=L[1],P=L[2];switch(L.length){case 0:while(++M<K){(O=N[M]).callback.call(O.ctx)}return;case 1:while(++M<K){(O=N[M]).callback.call(O.ctx,J)}return;case 2:while(++M<K){(O=N[M]).callback.call(O.ctx,J,I)}return;case 3:while(++M<K){(O=N[M]).callback.call(O.ctx,J,I,P)}return;default:while(++M<K){(O=N[M]).callback.apply(O.ctx,L)}return}};p.bind=p.on;p.unbind=p.off;F.extend(c,p);var m=c.Model=function(I,K){var J=I||{};K||(K={});this.cid=F.uniqueId("c");this.attributes={};if(K.collection){this.collection=K.collection}if(K.parse){J=this.parse(J,K)||{}}J=F.defaults({},J,F.result(this,"defaults"));this.set(J,K);this.changed={};this.initialize.apply(this,arguments)};F.extend(m.prototype,p,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(I){return F.clone(this.attributes)},sync:function(){return c.sync.apply(this,arguments)},get:function(I){return this.attributes[I]},escape:function(I){return F.escape(this.get(I))},has:function(I){return this.get(I)!=null},matches:function(I){return F.matches(I)(this.attributes)},set:function(Q,J,U){var O,R,S,P,N,T,K,M;if(Q==null){return this}if(typeof Q==="object"){R=Q;U=J}else{(R={})[Q]=J}U||(U={});if(!this._validate(R,U)){return false}S=U.unset;N=U.silent;P=[];T=this._changing;this._changing=true;if(!T){this._previousAttributes=F.clone(this.attributes);this.changed={}}M=this.attributes,K=this._previousAttributes;if(this.idAttribute in R){this.id=R[this.idAttribute]}for(O in R){J=R[O];if(!F.isEqual(M[O],J)){P.push(O)}if(!F.isEqual(K[O],J)){this.changed[O]=J}else{delete this.changed[O]}S?delete M[O]:M[O]=J}if(!N){if(P.length){this._pending=U}for(var L=0,I=P.length;L<I;L++){this.trigger("change:"+P[L],this,M[P[L]],U)}}if(T){return this}if(!N){while(this._pending){U=this._pending;this._pending=false;this.trigger("change",this,U)}}this._pending=false;this._changing=false;return this},unset:function(I,J){return this.set(I,void 0,F.extend({},J,{unset:true}))},clear:function(J){var I={};for(var K in this.attributes){I[K]=void 0}return this.set(I,F.extend({},J,{unset:true}))},hasChanged:function(I){if(I==null){return !F.isEmpty(this.changed)}return F.has(this.changed,I)},changedAttributes:function(K){if(!K){return this.hasChanged()?F.clone(this.changed):false}var M,L=false;var J=this._changing?this._previousAttributes:this.attributes;for(var I in K){if(F.isEqual(J[I],(M=K[I]))){continue}(L||(L={}))[I]=M}return L},previous:function(I){if(I==null||!this._previousAttributes){return null}return this._previousAttributes[I]},previousAttributes:function(){return F.clone(this._previousAttributes)},fetch:function(J){J=J?F.clone(J):{};if(J.parse===void 0){J.parse=true}var I=this;var K=J.success;J.success=function(L){if(!I.set(I.parse(L,J),J)){return false}if(K){K(I,L,J)}I.trigger("sync",I,L,J)};e(this,J);return this.sync("read",this,J)},save:function(M,J,Q){var N,I,P,K=this.attributes;if(M==null||typeof M==="object"){N=M;Q=J}else{(N={})[M]=J}Q=F.extend({validate:true},Q);if(N&&!Q.wait){if(!this.set(N,Q)){return false}}else{if(!this._validate(N,Q)){return false}}if(N&&Q.wait){this.attributes=F.extend({},K,N)}if(Q.parse===void 0){Q.parse=true}var L=this;var O=Q.success;Q.success=function(S){L.attributes=K;var R=L.parse(S,Q);if(Q.wait){R=F.extend(N||{},R)}if(F.isObject(R)&&!L.set(R,Q)){return false}if(O){O(L,S,Q)}L.trigger("sync",L,S,Q)};e(this,Q);I=this.isNew()?"create":(Q.patch?"patch":"update");if(I==="patch"&&!Q.attrs){Q.attrs=N}P=this.sync(I,this,Q);if(N&&Q.wait){this.attributes=K}return P},destroy:function(J){J=J?F.clone(J):{};var I=this;var M=J.success;var K=function(){I.stopListening();I.trigger("destroy",I,I.collection,J)};J.success=function(N){if(J.wait||I.isNew()){K()}if(M){M(I,N,J)}if(!I.isNew()){I.trigger("sync",I,N,J)}};if(this.isNew()){J.success();return false}e(this,J);var L=this.sync("delete",this,J);if(!J.wait){K()}return L},url:function(){var I=F.result(this,"urlRoot")||F.result(this.collection,"url")||w();if(this.isNew()){return I}return I.replace(/([^\/])$/,"$1/")+encodeURIComponent(this.id)},parse:function(J,I){return J},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return !this.has(this.idAttribute)},isValid:function(I){return this._validate({},F.extend(I||{},{validate:true}))},_validate:function(K,J){if(!J.validate||!this.validate){return true}K=F.extend({},this.attributes,K);var I=this.validationError=this.validate(K,J)||null;if(!I){return true}this.trigger("invalid",this,I,F.extend(J,{validationError:I}));return false}});var B=["keys","values","pairs","invert","pick","omit","chain","isEmpty"];F.each(B,function(I){if(!F[I]){return}m.prototype[I]=function(){var J=r.call(arguments);J.unshift(this.attributes);return F[I].apply(F,J)}});var G=c.Collection=function(J,I){I||(I={});if(I.model){this.model=I.model}if(I.comparator!==void 0){this.comparator=I.comparator}this._reset();this.initialize.apply(this,arguments);if(J){this.reset(J,F.extend({silent:true},I))}};var y={add:true,remove:true,merge:true};var n={add:true,remove:false};F.extend(G.prototype,p,{model:m,initialize:function(){},toJSON:function(I){return this.map(function(J){return J.toJSON(I)})},sync:function(){return c.sync.apply(this,arguments)},add:function(J,I){return this.set(J,F.extend({merge:false},I,n))},remove:function(P,K){var M=!F.isArray(P);P=M?[P]:F.clone(P);K||(K={});for(var L=0,N=P.length;L<N;L++){var J=P[L]=this.get(P[L]);if(!J){continue}var O=this.modelId(J.attributes);if(O!=null){delete this._byId[O]}delete this._byId[J.cid];var I=this.indexOf(J);this.models.splice(I,1);this.length--;if(!K.silent){K.index=I;J.trigger("remove",J,this,K)}this._removeReference(J,K)}return M?P[0]:P},set:function(ac,K){K=F.defaults({},K,y);if(K.parse){ac=this.parse(ac,K)}var O=!F.isArray(ac);ac=O?(ac?[ac]:[]):ac.slice();var T,L,V,S,ab;var Q=K.at;if(Q!=null){Q=+Q}if(Q<0){Q+=this.length+1}var I=this.comparator&&(Q==null)&&K.sort!==false;var aa=F.isString(this.comparator)?this.comparator:null;var ad=[],W=[],U={};var R=K.add,M=K.merge,ae=K.remove;var Y=!I&&R&&ae?[]:false;var X=false;for(var Z=0,J=ac.length;Z<J;Z++){V=ac[Z];if(S=this.get(V)){if(ae){U[S.cid]=true}if(M&&V!==S){V=this._isModel(V)?V.attributes:V;if(K.parse){V=S.parse(V,K)}S.set(V,K);if(I&&!ab&&S.hasChanged(aa)){ab=true}}ac[Z]=S}else{if(R){L=ac[Z]=this._prepareModel(V,K);if(!L){continue}ad.push(L);this._addReference(L,K)}}L=S||L;if(!L){continue}T=this.modelId(L.attributes);if(Y&&(L.isNew()||!U[T])){Y.push(L);X=X||!this.models[Z]||L.cid!==this.models[Z].cid}U[T]=true}if(ae){for(var Z=0,J=this.length;Z<J;Z++){if(!U[(L=this.models[Z]).cid]){W.push(L)}}if(W.length){this.remove(W,K)}}if(ad.length||X){if(I){ab=true}this.length+=ad.length;if(Q!=null){for(var Z=0,J=ad.length;Z<J;Z++){this.models.splice(Q+Z,0,ad[Z])}}else{if(Y){this.models.length=0}var P=Y||ad;for(var Z=0,J=P.length;Z<J;Z++){this.models.push(P[Z])}}}if(ab){this.sort({silent:true})}if(!K.silent){var N=Q!=null?F.clone(K):K;for(var Z=0,J=ad.length;Z<J;Z++){if(Q!=null){N.index=Q+Z}(L=ad[Z]).trigger("add",L,this,N)}if(ab||X){this.trigger("sort",this,K)}}return O?ac[0]:ac},reset:function(L,I){I=I?F.clone(I):{};for(var J=0,K=this.models.length;J<K;J++){this._removeReference(this.models[J],I)}I.previousModels=this.models;this._reset();L=this.add(L,F.extend({silent:true},I));if(!I.silent){this.trigger("reset",this,I)}return L},push:function(J,I){return this.add(J,F.extend({at:this.length},I))},pop:function(J){var I=this.at(this.length-1);this.remove(I,J);return I},unshift:function(J,I){return this.add(J,F.extend({at:0},I))},shift:function(J){var I=this.at(0);this.remove(I,J);return I},slice:function(){return r.apply(this.models,arguments)},get:function(I){if(I==null){return void 0}var J=this.modelId(this._isModel(I)?I.attributes:I);return this._byId[I]||this._byId[J]||this._byId[I.cid]},at:function(I){if(I<0){I+=this.length}return this.models[I]},where:function(I,K){var J=F.matches(I);return this[K?"find":"filter"](function(L){return J(L.attributes)})},findWhere:function(I){return this.where(I,true)},sort:function(I){if(!this.comparator){throw new Error("Cannot sort a set without a comparator")}I||(I={});if(F.isString(this.comparator)||this.comparator.length===1){this.models=this.sortBy(this.comparator,this)}else{this.models.sort(F.bind(this.comparator,this))}if(!I.silent){this.trigger("sort",this,I)}return this},pluck:function(I){return F.invoke(this.models,"get",I)},fetch:function(I){I=I?F.clone(I):{};if(I.parse===void 0){I.parse=true}var K=I.success;var J=this;I.success=function(L){var M=I.reset?"reset":"set";J[M](L,I);if(K){K(J,L,I)}J.trigger("sync",J,L,I)};e(this,I);return this.sync("read",this,I)},create:function(J,I){I=I?F.clone(I):{};if(!(J=this._prepareModel(J,I))){return false}if(!I.wait){this.add(J,I)}var L=this;var K=I.success;I.success=function(M,N){if(I.wait){L.add(M,I)}if(K){K(M,N,I)}};J.save(null,I);return J},parse:function(J,I){return J},clone:function(){return new this.constructor(this.models,{model:this.model,comparator:this.comparator})},modelId:function(I){return I[this.model.prototype.idAttribute||"id"]},_reset:function(){this.length=0;this.models=[];this._byId={}},_prepareModel:function(K,J){if(this._isModel(K)){if(!K.collection){K.collection=this}return K}J=J?F.clone(J):{};J.collection=this;var I=new this.model(K,J);if(!I.validationError){return I}this.trigger("invalid",this,I.validationError,J);return false},_isModel:function(I){return I instanceof m},_addReference:function(J,I){this._byId[J.cid]=J;var K=this.modelId(J.attributes);if(K!=null){this._byId[K]=J}J.on("all",this._onModelEvent,this)},_removeReference:function(J,I){if(this===J.collection){delete J.collection}J.off("all",this._onModelEvent,this)},_onModelEvent:function(K,J,M,I){if((K==="add"||K==="remove")&&M!==this){return}if(K==="destroy"){this.remove(J,I)}if(K==="change"){var L=this.modelId(J.previousAttributes());var N=this.modelId(J.attributes);if(L!==N){if(L!=null){delete this._byId[L]}if(N!=null){this._byId[N]=J}}}this.trigger.apply(this,arguments)}});var C=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain","sample","partition"];F.each(C,function(I){if(!F[I]){return}G.prototype[I]=function(){var J=r.call(arguments);J.unshift(this.models);return F[I].apply(F,J)}});var i=["groupBy","countBy","sortBy","indexBy"];F.each(i,function(I){if(!F[I]){return}G.prototype[I]=function(L,J){var K=F.isFunction(L)?L:function(M){return M.get(L)};return F[I](this.models,K,J)}});var v=c.View=function(I){this.cid=F.uniqueId("view");I||(I={});F.extend(this,F.pick(I,x));this._ensureElement();this.initialize.apply(this,arguments)};var g=/^(\S+)\s*(.*)$/;var x=["model","collection","el","id","attributes","className","tagName","events"];F.extend(v.prototype,p,{tagName:"div",$:function(I){return this.$el.find(I)},initialize:function(){},render:function(){return this},remove:function(){this._removeElement();this.stopListening();return this},_removeElement:function(){this.$el.remove()},setElement:function(I){this.undelegateEvents();this._setElement(I);this.delegateEvents();return this},_setElement:function(I){this.$el=I instanceof c.$?I:c.$(I);this.el=this.$el[0]},delegateEvents:function(K){if(!(K||(K=F.result(this,"events")))){return this}this.undelegateEvents();for(var J in K){var L=K[J];if(!F.isFunction(L)){L=this[K[J]]}if(!L){continue}var I=J.match(g);this.delegate(I[1],I[2],F.bind(L,this))}return this},delegate:function(J,I,K){this.$el.on(J+".delegateEvents"+this.cid,I,K)},undelegateEvents:function(){if(this.$el){this.$el.off(".delegateEvents"+this.cid)}return this},undelegate:function(J,I,K){this.$el.off(J+".delegateEvents"+this.cid,I,K)},_createElement:function(I){return document.createElement(I)},_ensureElement:function(){if(!this.el){var I=F.extend({},F.result(this,"attributes"));if(this.id){I.id=F.result(this,"id")}if(this.className){I["class"]=F.result(this,"className")}this.setElement(this._createElement(F.result(this,"tagName")));this._setAttributes(I)}else{this.setElement(F.result(this,"el"))}},_setAttributes:function(I){this.$el.attr(I)}});c.sync=function(P,K,J){var M=t[P];F.defaults(J||(J={}),{emulateHTTP:c.emulateHTTP,emulateJSON:c.emulateJSON});var O={type:M,dataType:"json"};if(!J.url){O.url=F.result(K,"url")||w()}if(J.data==null&&K&&(P==="create"||P==="update"||P==="patch")){O.contentType="application/json";O.data=JSON.stringify(J.attrs||K.toJSON(J))}if(J.emulateJSON){O.contentType="application/x-www-form-urlencoded";O.data=O.data?{model:O.data}:{}}if(J.emulateHTTP&&(M==="PUT"||M==="DELETE"||M==="PATCH")){O.type="POST";if(J.emulateJSON){O.data._method=M}var L=J.beforeSend;J.beforeSend=function(Q){Q.setRequestHeader("X-HTTP-Method-Override",M);if(L){return L.apply(this,arguments)}}}if(O.type!=="GET"&&!J.emulateJSON){O.processData=false}var I=J.error;J.error=function(R,S,Q){J.textStatus=S;J.errorThrown=Q;if(I){I.apply(this,arguments)}};var N=J.xhr=c.ajax(F.extend(O,J));K.trigger("request",K,N,J);return N};var t={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};c.ajax=function(){return c.$.ajax.apply(c.$,arguments)};var E=c.Router=function(I){I||(I={});if(I.routes){this.routes=I.routes}this._bindRoutes();this.initialize.apply(this,arguments)};var l=/\((.*?)\)/g;var k=/(\(\?)?:\w+/g;var D=/\*\w+/g;var f=/[\-{}\[\]+?.,\\\^$|#\s]/g;F.extend(E.prototype,p,{initialize:function(){},route:function(J,K,L){if(!F.isRegExp(J)){J=this._routeToRegExp(J)}if(F.isFunction(K)){L=K;K=""}if(!L){L=this[K]}var I=this;c.history.route(J,function(N){var M=I._extractParameters(J,N);if(I.execute(L,M,K)!==false){I.trigger.apply(I,["route:"+K].concat(M));I.trigger("route",K,M);c.history.trigger("route",I,K,M)}});return this},execute:function(K,J,I){if(K){K.apply(this,J)}},navigate:function(J,I){c.history.navigate(J,I);return this},_bindRoutes:function(){if(!this.routes){return}this.routes=F.result(this,"routes");var J,I=F.keys(this.routes);while((J=I.pop())!=null){this.route(J,this.routes[J])}},_routeToRegExp:function(I){I=I.replace(f,"\\$&").replace(l,"(?:$1)?").replace(k,function(K,J){return J?K:"([^/?]+)"}).replace(D,"([^?]*?)");return new RegExp("^"+I+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(I,J){var K=I.exec(J).slice(1);return F.map(K,function(M,L){if(L===K.length-1){return M||null}return M?decodeURIComponent(M):null})}});var b=c.History=function(){this.handlers=[];F.bindAll(this,"checkUrl");if(typeof window!=="undefined"){this.location=window.location;this.history=window.history}};var o=/^[#\/]|\s+$/g;var A=/^\/+|\/+$/g;var u=/#.*$/;b.started=false;F.extend(b.prototype,p,{interval:50,atRoot:function(){var I=this.location.pathname.replace(/[^\/]$/,"$&/");return I===this.root&&!this.getSearch()},getSearch:function(){var I=this.location.href.replace(/#.*/,"").match(/\?.+/);return I?I[0]:""},getHash:function(J){var I=(J||this).location.href.match(/#(.*)$/);return I?I[1]:""},getPath:function(){var J=decodeURI(this.location.pathname+this.getSearch());var I=this.root.slice(0,-1);if(!J.indexOf(I)){J=J.slice(I.length)}return J.charAt(0)==="/"?J.slice(1):J},getFragment:function(I){if(I==null){if(this._hasPushState||!this._wantsHashChange){I=this.getPath()}else{I=this.getHash()}}return I.replace(o,"")},start:function(K){if(b.started){throw new Error("Backbone.history has already been started")}b.started=true;this.options=F.extend({root:"/"},this.options,K);this.root=this.options.root;this._wantsHashChange=this.options.hashChange!==false;this._hasHashChange="onhashchange" in window;this._wantsPushState=!!this.options.pushState;this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);this.fragment=this.getFragment();this.root=("/"+this.root+"/").replace(A,"/");if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot()){var J=this.root.slice(0,-1)||"/";this.location.replace(J+"#"+this.getPath());return true}else{if(this._hasPushState&&this.atRoot()){this.navigate(this.getHash(),{replace:true})}}}if(!this._hasHashChange&&this._wantsHashChange&&(!this._wantsPushState||!this._hasPushState)){var L=document.createElement("iframe");L.src="javascript:0";L.style.display="none";L.tabIndex=-1;var I=document.body;this.iframe=I.insertBefore(L,I.firstChild).contentWindow;this.iframe.document.open().close();this.iframe.location.hash="#"+this.fragment}var M=window.addEventListener||function(N,O){return attachEvent("on"+N,O)};if(this._hasPushState){M("popstate",this.checkUrl,false)}else{if(this._wantsHashChange&&this._hasHashChange&&!this.iframe){M("hashchange",this.checkUrl,false)}else{if(this._wantsHashChange){this._checkUrlInterval=setInterval(this.checkUrl,this.interval)}}}if(!this.options.silent){return this.loadUrl()}},stop:function(){var I=window.removeEventListener||function(J,K){return detachEvent("on"+J,K)};if(this._hasPushState){I("popstate",this.checkUrl,false)}else{if(this._wantsHashChange&&this._hasHashChange&&!this.iframe){I("hashchange",this.checkUrl,false)}}if(this.iframe){document.body.removeChild(this.iframe.frameElement);this.iframe=null}if(this._checkUrlInterval){clearInterval(this._checkUrlInterval)}b.started=false},route:function(I,J){this.handlers.unshift({route:I,callback:J})},checkUrl:function(J){var I=this.getFragment();if(I===this.fragment&&this.iframe){I=this.getHash(this.iframe)}if(I===this.fragment){return false}if(this.iframe){this.navigate(I)}this.loadUrl()},loadUrl:function(I){I=this.fragment=this.getFragment(I);return F.any(this.handlers,function(J){if(J.route.test(I)){J.callback(I);return true}})},navigate:function(L,K){if(!b.started){return false}if(!K||K===true){K={trigger:!!K}}L=this.getFragment(L||"");var I=this.root;if(L===""||L.charAt(0)==="?"){I=I.slice(0,-1)||"/"}var J=I+L;L=decodeURI(L.replace(u,""));if(this.fragment===L){return}this.fragment=L;if(this._hasPushState){this.history[K.replace?"replaceState":"pushState"]({},document.title,J)}else{if(this._wantsHashChange){this._updateHash(this.location,L,K.replace);if(this.iframe&&(L!==this.getHash(this.iframe))){if(!K.replace){this.iframe.document.open().close()}this._updateHash(this.iframe.location,L,K.replace)}}else{return this.location.assign(J)}}if(K.trigger){return this.loadUrl(L)}},_updateHash:function(I,K,L){if(L){var J=I.href.replace(/(javascript:|#).*$/,"");I.replace(J+"#"+K)}else{I.hash="#"+K}}});c.history=new b;var z=function(I,K){var J=this;var M;if(I&&F.has(I,"constructor")){M=I.constructor}else{M=function(){return J.apply(this,arguments)}}F.extend(M,J,K);var L=function(){this.constructor=M};L.prototype=J.prototype;M.prototype=new L;if(I){F.extend(M.prototype,I)}M.__super__=J.prototype;return M};m.extend=G.extend=E.extend=v.extend=b.extend=z;var w=function(){throw new Error('A "url" property or function must be specified')};var e=function(K,J){var I=J.error;J.error=function(L){if(I){I(K,L,J)}K.trigger("error",K,L,J)}};return c}));