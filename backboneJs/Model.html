<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>Model</title>
		<script src="js/jquery-1.11.3.js"></script>
		<script src="js/underscore.min.js"></script>
		<script src="js/backbone.min.js"></script>
	</head>
	<body>
		<script>
		// on
			var arr = Backbone.Model.extend({
				defaults:{
					name : 'sxy',
					sex :''
				}
			});
			var obj = new arr();
			obj.on('change',function(){
				console.log('发生改变')
			});
			obj.on("change:sex",function (model,value) {
				console.log('sex改为:'+ value);
			});
			obj.set("sex","male"); // 先执行属性监听，再执行原始默认监听
		// on 中的previous和previousAttributes
			var arr = Backbone.Model.extend({
				defaults:{
					name:'sxy',
					age:21,
					score:128
				}
			});
			var obj = new arr();
			obj.on('change:score',function(model,value){
//				var oldscore = model.previous('score');
				var objAttr = model.previousAttributes();
				var oldscore = objAttr.score;
				if(value>oldscore){
					console.log('比上次多了'+(value-oldscore)+'分')
				}
				else if(value<oldscore){
					console.log('比上次少了'+(oldscore-value)+'分')
				}
				else{
					console.log('没变化')
				}
			});
			obj.set('score','135')
		//once
			var intNum = 0;
			obj.once('change',function(){
				intNum++;
				console.log(intNum)
			});
			obj.set('age','22')
			obj.set('age','23')
			obj.set('age','24')
		//trigger
			var arr = Backbone.Model.extend({
				defaults:{
					name:'gatinul',
					age:21,
					sex:'male',
					score:120
				}
			});
			var obj = new arr();
			obj.on('change:age',function(model,value){
				if(value!=undefined){
					console.log('修改年龄为'+value);
				}
				else{
					console.log('手动触发事件')
				}
			})
			obj.trigger('change:age');
			obj.set('age','22')
		//off
			var arr = Backbone.Model.extend({
				defaults:{
					name:'sxy',
					age:21,
					sex:'male',
					score:130
				}
			});
			
		</script>
	</body>
</html>
